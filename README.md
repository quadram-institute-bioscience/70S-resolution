# resolution of the ribosomal RNA operon 
Scripts for replication of the rRNA operon manuscript. 
The reference genomes were downloaded from NCBI with the software [ncbi-genome-download](https://github.com/kblin/ncbi-genome-download) 
and are not included here due to space. They should be moved to directory `bigdata`. 

We also excluded from this repository the [taxonomic classification from GTDB](https://data.ace.uq.edu.au/public/gtdb/data/releases/release89/89.0/bac120_metadata_r89.tsv) (200MB), 
which should also be downloaded and moved to diredctory `bigdata`.

The intermediate files generated by the notebooks will be found in the subdirectories `024_results` and `026_results`.
Larger files were compressed with `gzip`, and the estimated phylogenetic trees can be plotted by running e.g.
```
R --no-save < plot_ggtree.R
```
inside these subdirectories. 

## Jupyter notebooks

There are four jupyter notebooks with the R and python 3.0 codes necessary to reproduce all analyses, with instructions on how
to download external data when needed. Should be run in order:

* [005.generate_gtdb_sheet.ipynb](005.generate_gtdb_sheet.ipynb) : R code to generate the classification table (from GTDB).
* [024.operon_paralogs.ipynb](024.operon_paralogs.ipynb) : extraction of multi-copy operons for selected genera.
* [026.concat_resolution.ipynb](026.concat_resolution.ipynb) : generation of single-copy data sets for all gene combinations.
* [028.monophyly_scores.ipynb](028.monophyly_scores.ipynb) : using results from [026.concat_resolution](026.concat_resolution.ipynb), 
calculates tree silhouette and monophyly scores. 

